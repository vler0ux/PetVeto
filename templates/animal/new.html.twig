{% extends 'base.html.twig' %}

{% block title %}Ajouter un animal - PetVeto{% endblock %}

{% block body %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow-sm">
                <div class="card-header bg-success text-white text-center">
                    <h2 class="mb-0">Ajouter un nouvel animal üêæ</h2>
                </div>
                <div class="card-body">
                    {{ form_start(form) }}
                    
                    <div class="mb-3">
                        {{ form_row(form.name) }}
                    </div>
                    <div class="mb-3">
                        {{ form_row(form.birthday) }}
                    </div>
                    <div class="mb-3">
                        {{ form_row(form.weight) }}
                    </div>
                    <div class=" mt-4">
                    {{ include('animal/_form.html.twig', { form: form }) }}
                        <button type="submit" class="btn btn-success">‚úÖ Valider l'ajout</button>
                    </div>

                    {{ form_end(form) }}
                </div>


            <div class="text-center mt-3">
                <a href="{{ path('app_user_home') }}" class="btn btn-outline-primary">üè† Retour √† l'accueil</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const toggleField = (selectField, containerId) => {
                const container = document.getElementById(containerId);

                const checkVisibility = () => {
                    console.log("Valeur de", selectField.name, "=", selectField.value);
                    if (selectField.value === "autre") {
                        container.style.display = "block";
                    } else {
                        container.style.display = "none";
                        const input = container.querySelector("input");
                        if (input) input.value = "";
                    }
                };

                if (selectField && container) {
                    checkVisibility();
                    selectField.addEventListener("change", checkVisibility);
                }
            };

        toggleField(document.querySelector("[name='animal[species]']"), "customSpeciesContainer");
        toggleField(document.querySelector("[name='animal[description]']"), "customDescriptionContainer");
        });
    </script>
{% endblock %}